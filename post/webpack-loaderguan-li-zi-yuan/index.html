<html>
  <head>
    <meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>loader：管理资源 | hviker</title>
<meta name="description" content="心游于艺，道不远人。" />
<link rel="shortcut icon" href="https://hviker.github.io/favicon.ico">
<link rel="stylesheet" href="https://hviker.github.io/styles/main.css">

<script src="https://hviker.github.io/media/js/jquery.min.js"></script>
<script src="https://hviker.github.io/media/js/masonry.pkgd.min.js"></script>
<script src="https://hviker.github.io/media/js/aos.js"></script>
<script src="https://hviker.github.io/media/js/pace.min.js"></script>
<script src="https://hviker.github.io/media/js/view-image.min.js"></script>
<script src="https://hviker.github.io/media/js/jquery.magnific-popup.min.js"></script>
<script src="https://hviker.github.io/media/js/functions.js"></script>
    <meta name="referrer" content="never">
    <meta name="description" content="1 链式loader执行顺序
一组链式的loader讲按照相反的顺序执行，从右到左。
链式的最后一个loader将转换过后的结果传递给前一个loader，以此类推。链中的第一个loader，返回webpack期望的js。
2 管理资源
对于..." />
    <meta name="keywords" content="webpack" />
    <script src="https://hviker.github.io/media/js/waterfall.min.js"></script>
    <script src="https://hviker.github.io/media/js/prism.min.js"></script>
  </head>
  <body>
            <header id="header" class="grid-container">
        <!-- start: .menu-wrapper -->
        <div class="menu-mobile"> 
          <i class="fa fa-reorder"></i>
        </div>
        <div class="menu-wrapper">
          <div class="">
            <div class="logo">
              <a href="https://hviker.github.io"><img src="/media/images/custom-headerLogo.png" alt=""></a>
            </div>
            <!-- start: .main-nav -->

            <nav class="main-nav grid-container grid-parent">
              <ul id="menu-header" class="menu gradient-effect">
                <li class=""><a href="https://hviker.github.io" class="menu">首页</a></li>
                
                  <li class="" >
                    <a href="/" class="menu">
                       
                    </a>
                  </li>
                
                  <li class="" >
                    <a href="/archives" class="menu">
                      归档
                    </a>
                  </li>
                
                  <li class="" >
                    <a href="/tags" class="menu">
                      标签
                    </a>
                  </li>
                
                  <li class="" >
                    <a href="/post/about" class="menu">
                      关于
                    </a>
                  </li>
                
                <li class="search-menu-item hide-on-mobile hide-on-tablet"><a href="#search-lightbox" class="lightbox mfp-inline"><i class="fa fa-search-line"></i></a></li>
              </ul>
            </nav>
            <a href="#search-lightbox" class="lightbox epcl-search-button mfp-inline hide-on-tablet hide-on-desktop"><i class="fa fa-search-line"></i></a>
            <!-- end: .main-nav -->
            <div class="clear"></div>
            <div class="border hide-on-tablet hide-on-mobile"></div>
          </div>    
          <div class="clear"></div>
        </div>
        <!-- end: .menu-wrapper -->
        <div class="clear"></div>
      </header>
      <div class="hide-on-mobile hide-on-tablet hide-on-desktop">
        <div id="search-lightbox" class="grid-container grid-small grid-parent mfp-hide">
          <div class="search-wrapper section">
            <form id="gridea-search-form" data-update="1620378923333" action="/search/index.html" class="search-form" _lpchecked="1">
              <input type="text" name="q" id="s" value="" class="search-field" placeholder="搜点啥..." aria-label="搜点啥..." required="">
              <button type="submit" class="submit" aria-label="Submit">
                <i class="fa fa-search-line"></i>
              </button>
            </form>
          </div>
        </div>
      </div>

      <main id="single" class="main grid-container fullcover no-sidebar aos-init aos-animate" data-aos="fade">

        <div class="center content">
          <div class="featured-image cover" style="background-image: url('/media/images/gridea.jpg');">
            <div class="meta top"> 
              <time class="meta-info" style="float:left;" datetime="2021-05-06"><i class="fa fa-calendar"></i><span class="lately">1 天前</span></time>
              
            </div>
            <div class="info">
              <div class="tags ">
                
                      <a href="https://hviker.github.io/tag/VFjcKMN5n/" class="ctag ctag-0 ctag-VFjcKMN5n" aria-label="">webpack</a>
                    
              </div>
              <h1 class="title ularge white bold">loader：管理资源</h1>
            </div>
          </div>
        </div>  

        <div class="epcl-page-wrapper">
          <div class="left-content grid-70 np-mobile">
            <article class="main-article post">
              <section class="post-content">
                <div class="text">
                  <h3 id="1-链式loader执行顺序">1 链式loader执行顺序</h3>
<p>一组链式的loader讲按照相反的顺序执行，从右到左。</p>
<p>链式的最后一个loader将转换过后的结果传递给前一个loader，以此类推。链中的第一个loader，返回webpack期望的js。</p>
<h3 id="2-管理资源">2 管理资源</h3>
<p>对于webapack来说，默认只能打包js文件，或者说是js模块。</p>
<p>Webpack中的loader可以引入、打包非js文件/模块。</p>
<p>当webpack对项目代码进行打包时，遇到非js文件，会去webpack的配置文件中查找module节点，查询有没有配置去处理对应的节点。</p>
<p>允许将文件从不同的语言(如ts)转换为js,或者将内联图片转换为data URL,允许直接在js模块中import css文件。</p>
<h4 id="21-加载css">2.1 加载css</h4>
<p>需要安装 <a href="https://v4.webpack.docschina.org/loaders/style-loader">style-loader</a> 和 <a href="https://v4.webpack.docschina.org/loaders/css-loader">css-loader</a></p>
<pre><code class="language-js">npm install --save-dev style-loader css-loader
</code></pre>
<p>webpack根据正则表达式，来查找所有以.css结尾的文件，都将被提供style-loader，css-loader。</p>
<p><strong>这样可以使你在js文件中使用import './style.css'。</strong></p>
<p><strong>在编译该模块时，引入的style.css将会被<code>&lt;style&gt;</code>给包裹，并添加到html的<code>&lt;head&gt;</code>中。</strong></p>
<pre><code class="language-js"> module: {
    rules: [
      {
        test: /\.css$/,
        use: [&quot;style-loader&quot;, &quot;css-loader&quot;],
      }
    ]
 }
</code></pre>
<p><strong>Q1: 为什么先引入style-loader,后引入css-loader ?</strong></p>
<p>1、css-loader的作用： 帮助解析css文件中的css代码，除了正常的css代码外，还解析css中的@import、url(..)这种方法来实现require的功能，但是样式内容并没有添加到<code>&lt;style&gt;</code>中。</p>
<p>2、style-loader的作用：帮助我们将css-loader解析后的内容包裹在<code>&lt;style&gt;</code>中，并添加到html的<code>&lt;head&gt;</code>中。</p>
<p>3、loader执行顺序，从右往左。webpack肯定是现将所有css模块解析完成后再添加到style标签中，所有css-loader在后，style-loader在前。</p>
<h4 id="22-加载images图像">2.2 加载images图像</h4>
<p>对于图片，不管是css中的background-image，还是<code>img</code>中的src，使用file-loader | url-loader进行处理。</p>
<p>**file-loader解决了路径引入问题。**拿图片来说，webpack打包后这些图片的打包路径可能和编码中引入路径不一样，比如开发坏境中引入./images目录下的图片，但是打包却打包到./imgs文件夹下，设置更多文件夹嵌套，导致引用出现问题。file-loader会修改打包后图片的存储路径，首先会将图片移动到output所在文件夹，并且随机生成一个hash值座位图片的名字。并将打包后的图片名称返回import | require函数。</p>
<pre><code class="language-js">{
  test: /\.(png|svg|jpe?g|gif)$/i,
    use: [
      {
        loader: &quot;file-loader&quot;,
        options: {
          name: &quot;[name]_[hash:7].[ext]&quot;,
          outputPath: 'images/'
        }
      }
    ]
}
</code></pre>
<p><code>file-loader</code>的常用配置项(options)</p>
<p>name: 设置打包生成文件的名称。其中，<code>[name]</code>: 源文件名； <code>[hash]</code>: 随机生成的hash值,<code>:6</code> 表示生成的hash值截取前6位； <code>[ext]</code>: 源文件后缀； <strong>一定要用<code>&quot;&quot;</code>包裹。</strong></p>
<p><code>outputPath</code>: 打包文件目录，相对路径，相对于output的设置。我们最终导出的文件路径为<code>output.path + file-loader.outputPath + file-loader.name</code>。例如上面images,会在dist文件夹下创建images文件夹并存储文件。</p>
<p><code>publicPath</code>:指定最终引用的文件路径(打包生成的index.html文件里面引用资源的前缀)。最终引用文件路径：<code>output.outputPath + file-loader.outputPath + file-loader.name</code> 。例如访问文件路径为http://localhost:8080/dist/images,其中output.publicPath默认为/dist, 这里可以设置为<code>images/</code>。</p>
<p>url-loader:https://www.npmjs.com/package/url-loader</p>
<p>url-loader: 内置file-loader。使用url-loader时，可以不用安装file-loader。</p>
<p>当图片较多时会发起很多http请求，会降低页面的性能，这个问题可以使用url-loader进行解决。url-loader会将引入的图片编码，生成dataURL并将其打包到文件中。最终不需要请求直接访问这个dataURL就能访问图片。如果图片过大编码过程将会降低性能，建议将较小的图标设置为baseURL。</p>
<p>url-loader提供了limit参数，如果文件小于limit限制，则返回DataURL（根据encoding设置，默认base64，也可以设置utf-8等），如果大于则会调用file-loader。</p>
<p><strong>进一步压缩、优化图片：</strong></p>
<p>图片压缩： image-webpack-loader</p>
<pre><code class="language-js">{
  loader: &quot;image-webpack-loader&quot;,
  options: {
  	bypassOnDebug: true,
  }
}
</code></pre>
<p>loader中使用<code>image-webpack-loader</code>时经常报错：Cannot find module 'imagemin-gifsicle'</p>
<figure data-type="image" tabindex="1"><img src="https://hviker.github.io/post-images/1620292261813.png" alt="" loading="lazy"></figure>
<p>这是因为npm下载包时下载不全导致的。</p>
<p>解决方法：</p>
<ol>
<li>
<p>不要使用npm，使用cnpm i image-webpack-loader@6.0.0 -D;  这里一定要加版本号，如果不加版本号很容易下载不下来。</p>
</li>
<li>
<p>使用cnpm下载低版本的包。</p>
</li>
</ol>
<p>比较url-loader、file-loader:https://segmentfault.com/a/1190000018987483?utm_source=tag-newest</p>
<p><strong>最终对图片的优化loader为：</strong></p>
<p>这里先对图片使用<code>image-webpack-loader</code>进行压缩为二次图片，二次图片再使用<code>url-loader</code>。</p>
<p>当二次图片大小大于8k直接使用压缩后的文件，小于8k是进行base64编码。</p>
<pre><code class="language-js">module: {
    rules: [
      {
        test: /\.(png|svg|jpe?g|gif)$/,
        use: [
          {
            loader: &quot;url-loader&quot;,
            options: {
              limit: 8192, // 8k
              name: '[name]_[hash:7].[ext]',
            }
          },
          {
            loader: &quot;image-webpack-loader&quot;,
            options: {
              bypassOnDebug: true,
            }
          }
        ],
      },
    ],
  }
</code></pre>
<p>这里能够看到原图片压缩了70%</p>
<figure data-type="image" tabindex="2"><img src="https://hviker.github.io/post-images/1620292269806.png" alt="" loading="lazy"></figure>
<h4 id="23-加载font字体">2.3 加载font字体</h4>
<p>使用file-loader 或者 url-loader可以接收、加载字体文件。<br>
<strong>对指定文件添加loader</strong></p>
<pre><code class="language-js">module: {
    rules: [
      {
        test: /\.(woff|woff2|eot|ttf|otf)$/,
        use: [
          'url-loader'
        ]
      }
    ],
  }
</code></pre>
<p>​	存放字体文件并使用<code>@font-face</code>声明混合。url(...)指令会给webpack处理。</p>
<figure data-type="image" tabindex="3"><img src="https://hviker.github.io/post-images/1620292277356.png" alt="" loading="lazy"></figure>
<figure data-type="image" tabindex="4"><img src="https://hviker.github.io/post-images/1620292281555.png" alt="" loading="lazy"></figure>
<h4 id="24-加载csvtsvxml数据">2.4 加载csv|tsv|xml数据</h4>
<p>对于数据，json属于内置的，也就是说使用import导入.json文件时默认正常运行。但是如果导入CSV、TSV、XML时需要下载<a href="https://github.com/theplatapi/csv-loader">csv-loader</a> 和 <a href="https://github.com/gisikw/xml-loader">xml-loader</a>。</p>
<pre><code class="language-js">module: {
    rules: [
      {
        test: /\.(csv|tsv)$/,
        use: [
          'csv-loader'
        ]
      },
      {
        test: /\.xml$/,
        use: [
          'xml-loader'
        ]
      }
    ]
}   
</code></pre>

                </div>
                <div class="clear"></div>
              </section>
            </article>
            <div class="clear"></div>

            <section class="related section">
              
              <article class="prev grid-50 tablet-grid-50 grid-parent">
                <div class="thumb cover lazy loaded" style="background-image: url('https://hviker.github.io/media/images/VFjcKMN5n.jpg');"></div>
                 <a href="https://hviker.github.io/post/guan-li-shu-chu/" class="full-link"></a>
                 <div class="info">
                  <time datetime="2021-05-07">2021-05-07</time>
                  <h4 class="title white no-margin">管理输出</h4>
                </div>
                 <span class="epcl-button red">
                  <img src="https://hviker.github.io/media/images/left-arrow.svg" width="15" alt="Left Arrow">
                </span>
                <div class="overlay"></div>
              </article>
              
              
              <article class="next grid-50 tablet-grid-50 grid-parent">
                <div class="thumb cover lazy loaded" style="background-image: url('https://hviker.github.io/media/images/L-6nzPhRV.jpg');"></div>
                 <a href="https://hviker.github.io/post/vue20-bu-fen-api-zheng-li-yi/" class="full-link"></a>
                 <div class="info">
                  <time datetime="2021-04-28">2021-04-28</time>
                  <h4 class="title white no-margin">Vue2.0部分API整理(一)</h4>
                </div>
                 <span class="epcl-button red">
                  <img src="https://hviker.github.io/media/images/right-arrow.svg" width="15" alt="Left Arrow">
                </span>
                <div class="overlay"></div>
              </article>
              

                <div class="clear"></div>
            </section>

              <div class="clear"></div>
              
            
              <div id="comments" class="bg-white hosted ">
                
                  <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
<script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>

<div id="gitalk-container"></div>
<div class="clear"></div>

<script>
  var gitalk = new Gitalk({
    clientID: 'f68ae8f71a2215243ce9',
    clientSecret: '4425adb0890c433816522b291391cf173556ee5f',
    repo: 'hviker.github.io',
    owner: 'hviker',
    admin: ['hviker'],
    id: (location.pathname).substring(0, 49),      // Ensure uniqueness and length less than 50
    distractionFreeMode: false  // Facebook-like distraction free mode
  })

  gitalk.render('gitalk-container')
</script>

                
                
              </div>
            

            </div>
          </div>
      </main>

          <footer id="footer" class="grid-container">
        <div class="widgets row gradient-effect">
            <div class="default-sidebar border-effect">
              <div class="grid-33 tablet-grid-50 mobile-grid-100">
                <section id="tag_cloud-2" class="widget widget_epcl_posts_thumbs underline-effect">
                  <h4 class="widget-title title white bordered">最新文章</h4>
                  
                  
                  <article class="item post-0 post type-post status-publish format-standard has-post-thumbnail hentry">
                    <a href="https://hviker.github.io/post/mo-kuai-re-ti-huan/" class="thumb hover-effect">
                      <span class="fullimage cover" style="display:block;border-radius:50%;background-image: url('/media/images/gridea.jpg');"></span>
                    </a>
                    <div class="info gradient-effect">
                      <time datetime="2021-05-07">2021-05-07</time>
                      <h4 class="title usmall">
                        <a href="https://hviker.github.io/post/mo-kuai-re-ti-huan/">模块热替换</a>
                      </h4>
                    </div>
                    <div class="clear"></div>
                  </article>
                  
                  
                  
                  <article class="item post-1 post type-post status-publish format-standard has-post-thumbnail hentry">
                    <a href="https://hviker.github.io/post/kai-fa-huan-jing/" class="thumb hover-effect">
                      <span class="fullimage cover" style="display:block;border-radius:50%;background-image: url('/media/images/gridea.jpg');"></span>
                    </a>
                    <div class="info gradient-effect">
                      <time datetime="2021-05-07">2021-05-07</time>
                      <h4 class="title usmall">
                        <a href="https://hviker.github.io/post/kai-fa-huan-jing/">开发环境</a>
                      </h4>
                    </div>
                    <div class="clear"></div>
                  </article>
                  
                  
                  
                  <article class="item post-2 post type-post status-publish format-standard has-post-thumbnail hentry">
                    <a href="https://hviker.github.io/post/guan-li-shu-chu/" class="thumb hover-effect">
                      <span class="fullimage cover" style="display:block;border-radius:50%;background-image: url('/media/images/gridea.jpg');"></span>
                    </a>
                    <div class="info gradient-effect">
                      <time datetime="2021-05-07">2021-05-07</time>
                      <h4 class="title usmall">
                        <a href="https://hviker.github.io/post/guan-li-shu-chu/">管理输出</a>
                      </h4>
                    </div>
                    <div class="clear"></div>
                  </article>
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  
                  <div class="clear"></div>
                </section>
              </div>

              <div class="grid-33 tablet-grid-50 mobile-grid-100">
                <section id="tag_cloud-2" class="widget widget_tag_cloud underline-effect">
                  <h4 class="widget-title title white bordered">标签云</h4>
                  <div class="tagcloud">
                    
                      <a href="https://hviker.github.io/tag/VFjcKMN5n/" class="ctag ctag-0 ctag-VFjcKMN5n" aria-label="">webpack</a>
                    
                      <a href="https://hviker.github.io/tag/L-6nzPhRV/" class="ctag ctag-1 ctag-L-6nzPhRV" aria-label="">Vue2.0</a>
                    
                      <a href="https://hviker.github.io/tag/GXfbDeMZV/" class="ctag ctag-2 ctag-GXfbDeMZV" aria-label="">vue</a>
                    
                      <a href="https://hviker.github.io/tag/j1qkahhB3/" class="ctag ctag-3 ctag-j1qkahhB3" aria-label="">CSS</a>
                    
                      <a href="https://hviker.github.io/tag/LDwpAxA3l/" class="ctag ctag-4 ctag-LDwpAxA3l" aria-label="">培训</a>
                    
                      <a href="https://hviker.github.io/tag/OK2iMRMG6/" class="ctag ctag-5 ctag-OK2iMRMG6" aria-label="">JS</a>
                    
                      <a href="https://hviker.github.io/tag/1ZVkdNUAB/" class="ctag ctag-6 ctag-1ZVkdNUAB" aria-label="">前端工程化</a>
                    
                      <a href="https://hviker.github.io/tag/sPs52aHLl/" class="ctag ctag-7 ctag-sPs52aHLl" aria-label="">源码学习</a>
                    
                      <a href="https://hviker.github.io/tag/Ugt1CeixF/" class="ctag ctag-8 ctag-Ugt1CeixF" aria-label="">elementUI2.0</a>
                    
                      <a href="https://hviker.github.io/tag/qian-duan/" class="ctag ctag-9 ctag-qian-duan" aria-label="">前端</a>
                    
                      <a href="https://hviker.github.io/tag/WeNhJHfo1/" class="ctag ctag-10 ctag-WeNhJHfo1" aria-label="">前端组件</a>
                    
                      <a href="https://hviker.github.io/tag/nHH9c42oQ/" class="ctag ctag-11 ctag-nHH9c42oQ" aria-label="">解决方法</a>
                    
                      <a href="https://hviker.github.io/tag/z2AsGhmT2/" class="ctag ctag-12 ctag-z2AsGhmT2" aria-label="">echarts</a>
                    
                      <a href="https://hviker.github.io/tag/DIQF7868Q/" class="ctag ctag-13 ctag-DIQF7868Q" aria-label="">服务器</a>
                    
                      <a href="https://hviker.github.io/tag/uWbJmEwft/" class="ctag ctag-14 ctag-uWbJmEwft" aria-label="">D3</a>
                    
                      <a href="https://hviker.github.io/tag/37uX5bo02/" class="ctag ctag-15 ctag-37uX5bo02" aria-label="">Git</a>
                    
                      <a href="https://hviker.github.io/tag/rqmNkvREA/" class="ctag ctag-16 ctag-rqmNkvREA" aria-label="">后端</a>
                    
                      <a href="https://hviker.github.io/tag/idNHj5-gf/" class="ctag ctag-17 ctag-idNHj5-gf" aria-label="">Gridea</a>
                    
                  </div>
                  <div class="clear"></div>
                </section>
              </div>

              <div class="grid-33 tablet-grid-50 mobile-grid-100">
                <section id="epcl_about-2" class="widget widget_epcl_about underline-effect">
                  <h4 class="widget-title title white bordered">关于我</h4>
                  <div class="avatar">
                    <a href="" class="translate-effect thumb"><span class="fullimage cover" style="background-image: url(https://hviker.github.io/images/avatar.png);"></span></a>
                  </div>
                  <div class="info">
                    <h4 class="title small author-name gradient-effect no-margin"><a href="">hviker</a></h4>
                    <p class="founder">心游于艺，道不远人。</p>
                    <div class="social">
                      
                        
                      
                        
                      
                        
                      
                        
                      
                        
                      
                    </div> 
                  </div>
                  <div class="clear"></div>
                  </section>
              </div>

            </div>
            <div class="clear"></div>
        </div>

        <div class="logo">
          <a href="https://hviker.github.io"><img src="/media/images/custom-footerLogo.png" alt=""></a>
        </div>
        <p class="published border-effect">
          ©2019 共 60 篇文章
          <br/>
          Theme <a href="https://gridea.dev/" target="_blank">「breek」</a> Powered by <a href="https://gridea.dev/" target="_blank">「Gridea」</a>
        </p>
        
        <a href="javascript:void(0)" id="back-to-top" class="epcl-button dark" style="display:none">
          <i class="fa fa-arrow"></i>
        </a>
    </footer>
    
    <div class="clear"></div>

        

      
    <script src="https://hviker.github.io/media/js/functions-post.js"></script>

    </div>
    <!-- end: #wrapper -->
  </body>
</html>
